{% extends 'plots/base.html' %}

{% block cssContent %}
{% endblock cssContent %}

{% block content %}

<div class="row">
  <div class="col s12 m10 l8 offset-m1 offset-l2">
    <div class="card-panel hoverable ">
      <div class="row">
        <form action="{% url 'plots:edit_profile' %}" method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="col s12 m12 l5 center-align">
            <div class="col s12 center-align">
              <img id="imgEdit" src="{{perfilForm.instance.avatar.url}}" class="circle responsive-img"
                style="height:150px; width: 150px;" />
            </div>
            <label for="id_avatar" class="btn waves-effect waves-light light-blue accent-4"><i
                class="material-icons left">camera_alt</i>Cambiar</label>
            <div class="col s12 center-align">
              <div class="file-field input-field">
                <div class="file-path-wrapper">
                  <input input type="file" name="avatar" accept="image/*" id="id_avatar">
                </div>
              </div>
            </div>
          </div>
          <div class="col s12 m12 l7">

            <div class="input-field">
              <i class="material-icons prefix">person</i>
              <label for="{{ userForm.first_name.auto_id }}" class="active">{{ userForm.first_name.label }}</label>
              {{ userForm.first_name }}
            </div>

            <div class="input-field">
              <i class="material-icons prefix">person_add</i>
              <label for="{{ userForm.last_name.auto_id }}" class="active">{{ userForm.last_name.label }}</label>
              {{ userForm.last_name }}
            </div>

            <div class="input-field">
              <i class="material-icons prefix">mail_outline</i>
              <label for="{{ userForm.email.auto_id }}" class="active">{{ userForm.email.label }}</label>
              {{ userForm.email }}
              {% if userForm.email.errors %}
              <ul style="margin-top: 0px; margin-bottom: 0px;">
                {% for error in userForm.email.errors %}
                <li><span class="red-text text-darken-1">{{ error }}</span></li>
                {% endfor %}
              </ul>
              {% endif %}
            </div>

          </div>
          <div class="col s12 m12 l12">

            <div class="input-field" style="margin-bottom: 23px; margin-top: 0px;">
              <i class="material-icons prefix">wc</i>
              {{ perfilForm.gender }}
              <label for="{{ perfilForm.gender.auto_id }}">{{ perfilForm.gender.label }}</label>
            </div>

            <div class="input-field">
              <i class="material-icons prefix">location_city</i>
              <label for="{{ perfilForm.location.auto_id }}" class="active">{{ perfilForm.location.label }}</label>
              {{ perfilForm.location }}
            </div>

            <div class="input-field">
              <i class="material-icons prefix">info</i>
              <label for="{{ perfilForm.information.auto_id }}"
                class="active">{{ perfilForm.information.label }}</label>
              {{ perfilForm.information }}
            </div>

            {% if perfilForm.avatar.errors %}
            {% for error in perfilForm.avatar.errors %}
            <p for="errorimage" class="active red-text text-darken-1" style="margin-top: -10px;"><i
                class="material-icons small" style="margin-right: 10px; margin-top: -10px">warning</i>
              {{ error }}</p>
            {% endfor %}
            {% endif %}


            <div class="row right-align">
              <div class="col s12" style="margin-bottom: -35px;">
                <a href="{{ request.META.HTTP_REFERER }}" class="btn waves-effect waves-light red darken-1">cancelar<i
                    class="material-icons right">cancel</i></a>
                <button type="submit" class="btn waves-effect waves-light light-blue accent-4">Guardar<i
                    class="material-icons right">save</i></button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block scriptsContent %}
<script type="text/javascript">
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function (e) {
        $('#imgEdit').attr('src', e.target.result);
      }

      reader.readAsDataURL(input.files[0]);
    }
  }

  $("#id_avatar").change(function () {
    readURL(this);
  });
</script>
{% endblock scriptsContent %}